<!DOCTYPE html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
<title>MakersBNB</title>
</head>
<body>
<nav class="navbar navbar-expand-lg bg-light">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">MakersBNB</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="/user">My account</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/properties">Properties</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/create_property">Create listing</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/requests">Requests</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/logout">Logout</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<h1>Request made by <%= @booker.name%> </h1>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
<p>Email: <%= @booker.email%></p>
<div>
      <p>Property name: <%= @property.name%></p>
      <p>Property location: <%= @property.location%></p>
      <p>Price per night: <%= @property.price%></p>
      <p>Request date: <%= @request_object.date%></p>
      <p>Owner name: <%= @lister.name%></p>
      <p>Owner email: <%= @lister.email%></p>
      <p>
      <% if @lister.id == @request_object.lister_id %> 
          <% if @request_object.confirmed == '2' && @property.availability == 't'%>
            <form>
            <button type="submit" name="confirm" value=1 formmethod='POST' formaction='/requests/<%= @request_object.id%>'>Approve</button>
            <button type="submit" name="confirm" value=0 formmethod='POST' formaction='/requests/<%= @request_object.id%>'>Deny</button>
            </form>
          <% end %>
      <%end%>
      <% if @request_object.confirmed == "1"%>
      <p>Status: Confirmed</p>
      <% elsif @request_object.confirmed == "0"%>
      <p>Status: Denied</p>
      <% else%>
      <p>Status: Waiting Approval...</p> 
      <%end%>

      </p> 
</div>
</body>
</html>